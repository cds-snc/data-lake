{
    "Job": {
        "Name": "Operations / GoogleAnalytics / DailyPages",
        "JobMode": "VISUAL",
        "JobRunQueuingEnabled": false,
        "Description": "",
        "Role": "arn:aws:iam::739275439843:role/service-role/AWSGlueETL-DataLake",
        "CreatedOn": "2025-12-18T20:44:51.146000+00:00",
        "LastModifiedOn": "2025-12-24T14:08:02.574000+00:00",
        "ExecutionProperty": {
            "MaxConcurrentRuns": 1
        },
        "Command": {
            "Name": "glueetl",
            "ScriptLocation": "s3://aws-glue-assets-739275439843-ca-central-1/scripts/Operations / GoogleAnalytics /Operations / GoogleAnalytics /Operations / GoogleAnalytics / DailyPages.py",
            "PythonVersion": "3"
        },
        "DefaultArguments": {
            "--enable-metrics": "true",
            "--enable-spark-ui": "true",
            "--spark-event-logs-path": "s3://aws-glue-assets-739275439843-ca-central-1/sparkHistoryLogs/",
            "--enable-job-insights": "true",
            "--enable-observability-metrics": "true",
            "--enable-glue-datacatalog": "true",
            "--job-bookmark-option": "job-bookmark-enable",
            "--job-language": "python",
            "--TempDir": "s3://aws-glue-assets-739275439843-ca-central-1/temporary/"
        },
        "MaxRetries": 0,
        "AllocatedCapacity": 10,
        "Timeout": 480,
        "MaxCapacity": 10.0,
        "WorkerType": "G.1X",
        "NumberOfWorkers": 10,
        "GlueVersion": "5.0",
        "CodeGenConfigurationNodes": {
            "node-1765980720494": {
                "S3JsonSource": {
                    "Name": "Superset",
                    "Paths": [
                        "s3://cds-data-lake-raw-production/operations/google-analytics/platform_core_superset_doc/daily_pages/"
                    ],
                    "Exclusions": [],
                    "Recurse": true,
                    "AdditionalOptions": {
                        "EnableSamplePath": false,
                        "SamplePath": "s3://cds-data-lake-raw-production/operations/google-analytics/platform_core_superset_doc/daily_pages/date=2025-11-12/data.json"
                    },
                    "JsonPath": "",
                    "Multiline": false,
                    "OutputSchemas": [
                        {
                            "Columns": [
                                {
                                    "Name": "date",
                                    "Type": "string"
                                },
                                {
                                    "Name": "firstusermanualcampaignname",
                                    "Type": "string"
                                },
                                {
                                    "Name": "sessions",
                                    "Type": "string"
                                },
                                {
                                    "Name": "activeusers",
                                    "Type": "string"
                                }
                            ]
                        }
                    ]
                }
            },
            "node-1765980721031": {
                "S3JsonSource": {
                    "Name": "Client",
                    "Paths": [
                        "s3://cds-data-lake-raw-production/operations/google-analytics/platform_form_client/daily_pages/"
                    ],
                    "Exclusions": [],
                    "Recurse": true,
                    "AdditionalOptions": {
                        "EnableSamplePath": false,
                        "SamplePath": "s3://cds-data-lake-raw-production/operations/google-analytics/platform_form_client/daily_pages/date=2025-11-11/data.json"
                    },
                    "JsonPath": "",
                    "Multiline": false,
                    "OutputSchemas": [
                        {
                            "Columns": [
                                {
                                    "Name": "date",
                                    "Type": "string"
                                },
                                {
                                    "Name": "firstusermanualcampaignname",
                                    "Type": "string"
                                },
                                {
                                    "Name": "sessions",
                                    "Type": "string"
                                },
                                {
                                    "Name": "activeusers",
                                    "Type": "string"
                                }
                            ]
                        }
                    ]
                }
            },
            "node-1766585107176": {
                "SparkSQL": {
                    "Name": "SQL Query",
                    "Inputs": [
                        "node-1765980760918"
                    ],
                    "SqlQuery": "select\nto_date(date, 'yyyyMMdd') as dt,\n*\nfrom myDataSource",
                    "SqlAliases": [
                        {
                            "From": "node-1765980760918",
                            "Alias": "myDataSource"
                        }
                    ],
                    "OutputSchemas": [
                        {
                            "Columns": [
                                {
                                    "Name": "dt",
                                    "Type": "date"
                                },
                                {
                                    "Name": "ga_property",
                                    "Type": "string"
                                },
                                {
                                    "Name": "date",
                                    "Type": "string"
                                },
                                {
                                    "Name": "pageTitle",
                                    "Type": "string"
                                },
                                {
                                    "Name": "sessions",
                                    "Type": "string"
                                },
                                {
                                    "Name": "activeUsers",
                                    "Type": "string"
                                },
                                {
                                    "Name": "bounceRate",
                                    "Type": "string"
                                },
                                {
                                    "Name": "userEngagementDuration",
                                    "Type": "string"
                                }
                            ]
                        }
                    ]
                }
            },
            "node-1765980760918": {
                "SparkSQL": {
                    "Name": "SQL Query",
                    "Inputs": [
                        "node-1765980721031",
                        "node-1765980720494",
                        "node-1765980620381",
                        "node-1765979699147"
                    ],
                    "SqlQuery": "select\n\"forms_marketing_site\" as ga_property,\n*\nfrom superset\nUNION ALL\nselect\n\"platform_form_client\" as ga_property,\n*\nfrom client\nUNION ALL\nselect\n\"forms_marketing_site\" as ga_property,\n*\nfrom marketing\nUNION ALL\nselect\n\"notification_ga4\" as ga_property,\n*\nfrom notification",
                    "SqlAliases": [
                        {
                            "From": "node-1765980721031",
                            "Alias": "client"
                        },
                        {
                            "From": "node-1765980720494",
                            "Alias": "superset"
                        },
                        {
                            "From": "node-1765980620381",
                            "Alias": "notification"
                        },
                        {
                            "From": "node-1765979699147",
                            "Alias": "marketing"
                        }
                    ],
                    "OutputSchemas": [
                        {
                            "Columns": [
                                {
                                    "Name": "ga_property",
                                    "Type": "string"
                                },
                                {
                                    "Name": "dt",
                                    "Type": "date"
                                },
                                {
                                    "Name": "date",
                                    "Type": "string"
                                },
                                {
                                    "Name": "pageTitle",
                                    "Type": "string"
                                },
                                {
                                    "Name": "sessions",
                                    "Type": "string"
                                },
                                {
                                    "Name": "activeUsers",
                                    "Type": "string"
                                },
                                {
                                    "Name": "bounceRate",
                                    "Type": "string"
                                },
                                {
                                    "Name": "userEngagementDuration",
                                    "Type": "string"
                                }
                            ]
                        }
                    ]
                }
            },
            "node-1766089243013": {
                "S3GlueParquetTarget": {
                    "Name": "Amazon S3",
                    "Inputs": [
                        "node-1766583894786"
                    ],
                    "PartitionKeys": [],
                    "Path": "s3://cds-data-lake-transformed-production/operations/google-analytics/daily_pages/",
                    "Compression": "snappy",
                    "NumberTargetPartitions": "0",
                    "SchemaChangePolicy": {
                        "EnableUpdateCatalog": true,
                        "UpdateBehavior": "UPDATE_IN_DATABASE",
                        "Table": "operations_google_analytics_daily_pages",
                        "Database": "operations_google_analytics_production"
                    },
                    "AutoDataQuality": {
                        "IsEnabled": true,
                        "EvaluationContext": "EvaluateDataQuality_node1766089210397"
                    }
                }
            },
            "node-1765979699147": {
                "S3JsonSource": {
                    "Name": "Marketing",
                    "Paths": [
                        "s3://cds-data-lake-raw-production/operations/google-analytics/forms_marketing_site/daily_pages/"
                    ],
                    "Exclusions": [],
                    "Recurse": true,
                    "AdditionalOptions": {
                        "EnableSamplePath": false,
                        "SamplePath": "s3://cds-data-lake-raw-production/operations/google-analytics/forms_marketing_site/daily_pages/date=2025-11-11/data.json"
                    },
                    "JsonPath": "",
                    "Multiline": false,
                    "OutputSchemas": [
                        {
                            "Columns": [
                                {
                                    "Name": "date",
                                    "Type": "string"
                                },
                                {
                                    "Name": "pagetitle",
                                    "Type": "string"
                                },
                                {
                                    "Name": "sessions",
                                    "Type": "string"
                                },
                                {
                                    "Name": "activeusers",
                                    "Type": "string"
                                },
                                {
                                    "Name": "bouncerate",
                                    "Type": "string"
                                },
                                {
                                    "Name": "userengagementduration",
                                    "Type": "string"
                                }
                            ]
                        }
                    ]
                }
            },
            "node-1765980620381": {
                "S3JsonSource": {
                    "Name": "Notification",
                    "Paths": [
                        "s3://cds-data-lake-raw-production/operations/google-analytics/notification_ga4/daily_pages/"
                    ],
                    "Exclusions": [],
                    "Recurse": true,
                    "AdditionalOptions": {
                        "EnableSamplePath": false,
                        "SamplePath": "s3://cds-data-lake-raw-production/operations/google-analytics/notification_ga4/daily_pages/date=2025-11-11/data.json"
                    },
                    "JsonPath": "",
                    "Multiline": false,
                    "OutputSchemas": [
                        {
                            "Columns": [
                                {
                                    "Name": "date",
                                    "Type": "string"
                                },
                                {
                                    "Name": "pagetitle",
                                    "Type": "string"
                                },
                                {
                                    "Name": "sessions",
                                    "Type": "string"
                                },
                                {
                                    "Name": "activeusers",
                                    "Type": "string"
                                },
                                {
                                    "Name": "bouncerate",
                                    "Type": "string"
                                },
                                {
                                    "Name": "userengagementduration",
                                    "Type": "string"
                                }
                            ]
                        }
                    ]
                }
            },
            "node-1766583894786": {
                "ApplyMapping": {
                    "Name": "Change Schema",
                    "Inputs": [
                        "node-1766585107176"
                    ],
                    "Mapping": [
                        {
                            "ToKey": "ga_property",
                            "FromPath": [
                                "ga_property"
                            ],
                            "FromType": "string",
                            "ToType": "string",
                            "Dropped": false
                        },
                        {
                            "ToKey": "date",
                            "FromPath": [
                                "dt"
                            ],
                            "FromType": "date",
                            "ToType": "date",
                            "Dropped": false
                        },
                        {
                            "ToKey": "date",
                            "FromPath": [
                                "date"
                            ],
                            "FromType": "string",
                            "ToType": "date",
                            "Dropped": true
                        },
                        {
                            "ToKey": "pageTitle",
                            "FromPath": [
                                "pageTitle"
                            ],
                            "FromType": "string",
                            "ToType": "string",
                            "Dropped": false
                        },
                        {
                            "ToKey": "sessions",
                            "FromPath": [
                                "sessions"
                            ],
                            "FromType": "string",
                            "ToType": "string",
                            "Dropped": false
                        },
                        {
                            "ToKey": "activeUsers",
                            "FromPath": [
                                "activeUsers"
                            ],
                            "FromType": "string",
                            "ToType": "string",
                            "Dropped": false
                        },
                        {
                            "ToKey": "bounceRate",
                            "FromPath": [
                                "bounceRate"
                            ],
                            "FromType": "string",
                            "ToType": "string",
                            "Dropped": false
                        },
                        {
                            "ToKey": "userEngagementDuration",
                            "FromPath": [
                                "userEngagementDuration"
                            ],
                            "FromType": "string",
                            "ToType": "string",
                            "Dropped": false
                        }
                    ]
                }
            }
        },
        "ExecutionClass": "STANDARD"
    }
}
